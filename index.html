<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Dein persÃ¶nlicher Djerba Reisebegleiter - Offline-Guide, Budget-Tracker, Taxi-Rechner und mehr!">
    <meta name="theme-color" content="#0EA5E9">
    <title>Djerba Buddy ğŸï¸ - Dein Urlaubs-Assistent</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiRGplcmJhIEJ1ZGR5Iiwic2hvcnRfbmFtZSI6IkRqZXJiYSIsInN0YXJ0X3VybCI6Ii8iLCJkaXNwbGF5Ijoic3RhbmRhbG9uZSIsImJhY2tncm91bmRfY29sb3IiOiIjRkZGRkZGIiwidGhlbWVfY29sb3IiOiIjMEVBNUU5IiwiaWNvbnMiOlt7InNyYyI6ImRhdGE6aW1hZ2Uvc3ZnK3htbCwlM0NzdmclMjB4bWxucyUzRCdodHRwJTNBJTJGJTJGd3d3LnczLm9yZyUyRjIwMDAlMkZzdmcnJTIwdmlld0JveCUzRCcwJTIwMCUyMDEwMCUyMDEwMCclM0UlM0NyZWN0JTIwZmlsbCUzRCclMjMwRUE1RTknJTIwd2lkdGglM0QnMTAwJyUyMGhlaWdodCUzRCcxMDAnJTJGJTNFJTNDdGV4dCUyMHglM0QnNTAlMjUnJTIweSUzRCc1MCUyNSclMjBmb250LXNpemUlM0QnNTAnJTIwdGV4dC1hbmNob3IlM0QnbWlkZGxlJyUyMGR5JTNEJy4zZW0nJTNFJUYwJTlGJThGJTlEJUYwJTlGJThGJTk2JTNDJTJGdGV4dCUzRSUzQyUyRnN2ZyUzRSIsInNpemVzIjoiNTEyeDUxMiIsInR5cGUiOiJpbWFnZS9zdmcreG1sIn1dfQ==">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700;800&family=Caveat:wght@600;700&display=swap');
        
        :root {
            --ocean: #0EA5E9;
            --ocean-dark: #0284C7;
            --sand: #F59E0B;
            --sand-light: #FDE68A;
            --sunset: #F97316;
            --palm: #10B981;
            --bg: #F8FAFC;
            --card: #FFFFFF;
            --text: #1E293B;
            --text-light: #64748B;
            --border: #E2E8F0;
            --danger: #EF4444;
            --success: #10B981;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Outfit', sans-serif;
            background: linear-gradient(135deg, #E0F2FE 0%, #FEF3C7 100%);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* Decorative wave background */
        body::before {
            content: '';
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 300px;
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 320'%3E%3Cpath fill='%230EA5E9' fill-opacity='0.1' d='M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,122.7C672,117,768,139,864,154.7C960,171,1056,181,1152,165.3C1248,149,1344,107,1392,85.3L1440,64L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z'%3E%3C/path%3E%3C/svg%3E") no-repeat bottom;
            background-size: cover;
            pointer-events: none;
            z-index: 0;
        }
        
        .container {
            max-width: 500px;
            margin: 0 auto;
            padding: 16px;
            position: relative;
            z-index: 1;
            padding-bottom: 80px;
        }
        
        /* Header */
        .header {
            background: linear-gradient(135deg, var(--ocean) 0%, var(--ocean-dark) 100%);
            border-radius: 24px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: 'ğŸï¸';
            position: absolute;
            font-size: 120px;
            opacity: 0.15;
            right: -20px;
            top: -20px;
            transform: rotate(15deg);
        }
        
        .header h1 {
            font-family: 'Caveat', cursive;
            color: white;
            font-size: 2.5em;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            position: relative;
        }
        
        .header .subtitle {
            color: rgba(255,255,255,0.9);
            font-size: 0.9em;
            margin-top: 4px;
        }
        
        /* Tab Navigation */
        .tabs {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-bottom: 24px;
            background: white;
            padding: 12px;
            border-radius: 16px;
            box-shadow: var(--shadow);
        }
        
        .tab {
            background: transparent;
            border: none;
            padding: 12px 8px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 0.75em;
            font-weight: 600;
            color: var(--text-light);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }
        
        .tab-icon {
            font-size: 1.8em;
        }
        
        .tab.active {
            background: linear-gradient(135deg, var(--ocean), var(--ocean-dark));
            color: white;
            transform: scale(1.05);
        }
        
        .tab:not(.active):hover {
            background: var(--bg);
        }
        
        /* Content Sections */
        .section {
            display: none;
            animation: fadeIn 0.4s ease;
        }
        
        .section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Card Component */
        .card {
            background: var(--card);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: var(--shadow);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border);
        }
        
        .card-icon {
            font-size: 2em;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--ocean), var(--ocean-dark));
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .card-title {
            font-size: 1.3em;
            font-weight: 700;
            color: var(--text);
        }
        
        /* Attraction Cards */
        .attraction {
            cursor: pointer;
            border-left: 4px solid var(--ocean);
        }
        
        .attraction-meta {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            margin: 12px 0;
            font-size: 0.9em;
        }
        
        .meta-item {
            display: flex;
            align-items: center;
            gap: 4px;
            color: var(--text-light);
        }
        
        .kid-rating {
            display: inline-flex;
            gap: 2px;
            font-size: 1.2em;
        }
        
        .tip {
            background: linear-gradient(135deg, #FEF3C7, #FDE68A);
            border-left: 4px solid var(--sand);
            padding: 12px;
            border-radius: 8px;
            margin-top: 12px;
            font-size: 0.9em;
        }
        
        .tip-icon {
            font-size: 1.2em;
            margin-right: 6px;
        }
        
        /* Taxi Calculator */
        .input-group {
            margin-bottom: 16px;
        }
        
        .label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
        }
        
        select, input[type="number"], input[type="text"], input[type="date"] {
            width: 100%;
            padding: 14px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 1em;
            font-family: 'Outfit', sans-serif;
            transition: all 0.3s ease;
        }
        
        select:focus, input:focus {
            outline: none;
            border-color: var(--ocean);
            box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
        }
        
        .price-display {
            background: linear-gradient(135deg, var(--ocean), var(--ocean-dark));
            color: white;
            padding: 24px;
            border-radius: 16px;
            text-align: center;
            margin: 20px 0;
        }
        
        .price-label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 8px;
        }
        
        .price-amount {
            font-size: 2.5em;
            font-weight: 800;
            font-family: 'Caveat', cursive;
        }
        
        .price-euro {
            font-size: 1em;
            opacity: 0.8;
            margin-top: 4px;
        }
        
        /* Budget Tracker */
        .budget-summary {
            background: linear-gradient(135deg, #10B981, #059669);
            color: white;
            padding: 24px;
            border-radius: 16px;
            margin-bottom: 20px;
        }
        
        .budget-amount {
            font-size: 2.5em;
            font-weight: 800;
            font-family: 'Caveat', cursive;
            margin: 8px 0;
        }
        
        .budget-bar {
            background: rgba(255,255,255,0.3);
            height: 16px;
            border-radius: 8px;
            overflow: hidden;
            margin: 12px 0;
        }
        
        .budget-bar-fill {
            height: 100%;
            background: white;
            transition: width 0.5s ease;
            border-radius: 8px;
        }
        
        .budget-status {
            font-size: 1.2em;
            margin-top: 8px;
        }
        
        .expense-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid var(--border);
        }
        
        .expense-item:last-child {
            border-bottom: none;
        }
        
        .expense-category {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .category-icon {
            font-size: 1.5em;
        }
        
        .expense-amount {
            font-weight: 700;
            font-size: 1.1em;
            color: var(--danger);
        }
        
        /* Button */
        .btn {
            background: linear-gradient(135deg, var(--ocean), var(--ocean-dark));
            color: white;
            border: none;
            padding: 16px 24px;
            border-radius: 12px;
            font-size: 1em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow);
            width: 100%;
            margin-top: 12px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-delete {
            background: linear-gradient(135deg, var(--danger), #DC2626);
            padding: 8px 16px;
            width: auto;
            margin: 0;
            font-size: 0.9em;
        }
        
        /* Packing List */
        .checklist-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px;
            border-bottom: 1px solid var(--border);
            transition: background 0.2s ease;
        }
        
        .checklist-item:hover {
            background: var(--bg);
        }
        
        .checklist-item input[type="checkbox"] {
            width: 24px;
            height: 24px;
            cursor: pointer;
            accent-color: var(--ocean);
        }
        
        .checklist-item.checked {
            opacity: 0.6;
        }
        
        .checklist-item.checked .item-text {
            text-decoration: line-through;
        }
        
        .item-text {
            flex: 1;
            font-size: 1em;
        }
        
        /* Emergency */
        .emergency-number {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px;
            background: var(--bg);
            border-radius: 12px;
            margin-bottom: 12px;
            border-left: 4px solid var(--danger);
        }
        
        .number-info {
            flex: 1;
        }
        
        .number-label {
            font-weight: 600;
            margin-bottom: 4px;
        }
        
        .number-value {
            color: var(--ocean);
            font-size: 1.2em;
            font-weight: 700;
            font-family: 'Courier New', monospace;
        }
        
        .call-btn {
            background: var(--success);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            font-size: 1.2em;
            cursor: pointer;
        }
        
        /* Achievements */
        .achievement {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px;
            background: var(--bg);
            border-radius: 12px;
            margin-bottom: 12px;
        }
        
        .achievement.unlocked {
            background: linear-gradient(135deg, #FEF3C7, #FDE68A);
            border: 2px solid var(--sand);
        }
        
        .achievement.locked {
            opacity: 0.5;
        }
        
        .achievement-icon {
            font-size: 3em;
            filter: grayscale(1);
        }
        
        .achievement.unlocked .achievement-icon {
            filter: grayscale(0);
            animation: bounce 0.5s ease;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .achievement-info {
            flex: 1;
        }
        
        .achievement-title {
            font-weight: 700;
            font-size: 1.1em;
            margin-bottom: 4px;
        }
        
        .achievement-desc {
            font-size: 0.9em;
            color: var(--text-light);
        }
        
        /* Phrases */
        .phrase {
            background: var(--bg);
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 12px;
        }
        
        .phrase-de {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
        }
        
        .phrase-translation {
            color: var(--ocean);
            font-size: 1.1em;
            margin: 6px 0;
            font-weight: 600;
        }
        
        .phrase-phonetic {
            color: var(--text-light);
            font-style: italic;
            font-size: 0.9em;
        }
        
        /* Install prompt */
        .install-prompt {
            position: fixed;
            bottom: 80px;
            left: 16px;
            right: 16px;
            background: white;
            padding: 20px;
            border-radius: 16px;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            display: none;
            animation: slideUp 0.4s ease;
        }
        
        @keyframes slideUp {
            from { transform: translateY(100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .install-prompt.show {
            display: block;
        }
        
        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 16px;
        }
        
        .modal.show {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 24px;
            max-width: 500px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            animation: scaleIn 0.3s ease;
        }
        
        @keyframes scaleIn {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .modal-close {
            float: right;
            font-size: 2em;
            cursor: pointer;
            color: var(--text-light);
        }
        
        /* Responsive adjustments */
        @media (max-width: 480px) {
            .tabs {
                grid-template-columns: repeat(4, 1fr);
                gap: 6px;
                padding: 8px;
            }

            .tab {
                padding: 8px 4px;
                font-size: 0.7em;
            }

            .tab-icon {
                font-size: 1.5em;
            }
        }

        /* === IMPROVEMENTS === */

        /* Visited Badge on Attractions */
        .attraction {
            position: relative;
        }
        .visited-badge {
            position: absolute;
            top: 14px;
            right: 14px;
            background: var(--success);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.78em;
            font-weight: 700;
            pointer-events: none;
        }
        .attraction.visited-card {
            border-left-color: var(--success);
        }
        .btn-visited {
            background: transparent;
            border: 2px solid var(--border);
            padding: 6px 14px;
            border-radius: 8px;
            font-size: 0.85em;
            font-weight: 600;
            cursor: pointer;
            color: var(--text-light);
            transition: all 0.3s ease;
            margin-top: 10px;
        }
        .btn-visited:hover {
            border-color: var(--success);
            color: var(--success);
        }
        .visited-card .btn-visited {
            border-color: var(--success);
            color: var(--success);
            background: rgba(16, 185, 129, 0.08);
        }

        /* Packing Progress */
        .packing-progress {
            background: linear-gradient(135deg, var(--ocean), var(--ocean-dark));
            color: white;
            padding: 20px 24px;
            border-radius: 16px;
            margin-bottom: 20px;
            text-align: center;
        }
        .packing-progress-text {
            font-size: 1.8em;
            font-weight: 800;
            font-family: 'Caveat', cursive;
            margin: 4px 0;
        }
        .packing-progress-bar {
            background: rgba(255,255,255,0.3);
            height: 12px;
            border-radius: 6px;
            overflow: hidden;
            margin: 10px 0;
        }
        .packing-progress-fill {
            height: 100%;
            background: white;
            transition: width 0.5s ease;
            border-radius: 6px;
        }

        /* Category Breakdown */
        .category-bar {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
        }
        .category-bar-label {
            min-width: 80px;
            font-size: 0.88em;
            font-weight: 600;
        }
        .category-bar-track {
            flex: 1;
            background: var(--border);
            height: 10px;
            border-radius: 5px;
            overflow: hidden;
        }
        .category-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--ocean), var(--sand));
            border-radius: 5px;
            transition: width 0.5s ease;
        }
        .category-bar-amount {
            font-size: 0.88em;
            font-weight: 700;
            min-width: 58px;
            text-align: right;
            color: var(--danger);
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%) translateY(120px);
            background: linear-gradient(135deg, var(--sand), #D97706);
            color: white;
            padding: 14px 24px;
            border-radius: 16px;
            box-shadow: var(--shadow-lg);
            font-weight: 700;
            font-size: 1em;
            z-index: 3000;
            opacity: 0;
            transition: all 0.4s ease;
            text-align: center;
            max-width: 320px;
            pointer-events: none;
            white-space: nowrap;
        }
        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        /* Budget Edit */
        .btn-edit-budget {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.6);
            padding: 8px 18px;
            border-radius: 10px;
            font-size: 0.85em;
            font-weight: 600;
            cursor: pointer;
            margin-top: 12px;
            transition: all 0.3s ease;
            font-family: 'Outfit', sans-serif;
        }
        .btn-edit-budget:hover {
            background: rgba(255,255,255,0.3);
        }
        .budget-edit-form {
            display: none;
            margin-top: 12px;
            background: rgba(255,255,255,0.15);
            padding: 12px;
            border-radius: 10px;
        }
        .budget-edit-form.show {
            display: block;
        }
        .budget-edit-form input {
            background: rgba(255,255,255,0.9);
            border: none;
            padding: 10px;
            border-radius: 8px;
            font-size: 1em;
            width: 100%;
            margin-bottom: 8px;
            font-family: 'Outfit', sans-serif;
            color: var(--text);
        }
        .budget-edit-form .btn-save {
            background: white;
            color: var(--palm);
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            width: 100%;
            font-family: 'Outfit', sans-serif;
            font-size: 1em;
        }

        /* Budget bar dynamic color */
        .budget-bar-fill.warning { background: #FCD34D; }
        .budget-bar-fill.danger { background: #FCA5A5; }

        /* Essential Items Banner */
        .essential-banner {
            background: linear-gradient(135deg, var(--sunset), #EA580C);
            color: white;
            padding: 16px 20px;
            border-radius: 16px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 14px;
            box-shadow: var(--shadow);
            animation: fadeIn 0.4s ease;
        }
        .essential-banner-icon {
            font-size: 2em;
            flex-shrink: 0;
        }
        .essential-banner-label {
            font-size: 0.72em;
            opacity: 0.85;
            text-transform: uppercase;
            letter-spacing: 0.6px;
            margin-bottom: 2px;
        }
        .essential-banner-text {
            font-size: 1.25em;
            font-weight: 800;
            font-family: 'Caveat', cursive;
        }

        /* Person stats badge */
        .person-stats {
            margin-left: auto;
            font-size: 0.82em;
            color: var(--text-light);
            font-weight: 700;
            background: var(--bg);
            padding: 4px 10px;
            border-radius: 20px;
        }

        /* Packing item row */
        .packing-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 11px 0;
            border-bottom: 1px solid var(--border);
        }
        .packing-item:last-child { border-bottom: none; }
        .packing-item input[type="checkbox"] {
            width: 22px;
            height: 22px;
            cursor: pointer;
            accent-color: var(--ocean);
            flex-shrink: 0;
        }
        .packing-item-name {
            flex: 1;
            font-size: 0.95em;
            transition: all 0.2s;
        }
        .packing-item-qty {
            background: var(--bg);
            border: 1px solid var(--border);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.8em;
            font-weight: 700;
            color: var(--text-light);
            white-space: nowrap;
        }
        .packing-item.checked .packing-item-name {
            text-decoration: line-through;
            opacity: 0.42;
        }
        .packing-item-del {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1em;
            opacity: 0.3;
            padding: 4px 6px;
            border-radius: 6px;
            transition: opacity 0.2s, background 0.2s;
            flex-shrink: 0;
        }
        .packing-item-del:hover {
            opacity: 1;
            background: rgba(239, 68, 68, 0.1);
        }

        /* Add item form */
        .add-packing-form {
            display: flex;
            gap: 8px;
            margin-top: 14px;
            padding-top: 14px;
            border-top: 2px solid var(--border);
            flex-wrap: wrap;
        }
        .add-packing-form input[type="text"] {
            flex: 1;
            min-width: 110px;
            padding: 10px 12px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 0.9em;
            font-family: 'Outfit', sans-serif;
        }
        .add-packing-form input[type="number"] {
            width: 62px;
            padding: 10px 6px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 0.9em;
            font-family: 'Outfit', sans-serif;
            text-align: center;
        }
        .add-packing-form input:focus {
            outline: none;
            border-color: var(--ocean);
            box-shadow: 0 0 0 3px rgba(14,165,233,0.1);
        }
        .btn-add-item {
            background: linear-gradient(135deg, var(--ocean), var(--ocean-dark));
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            font-family: 'Outfit', sans-serif;
            font-size: 0.9em;
            white-space: nowrap;
            transition: all 0.2s ease;
        }
        .btn-add-item:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow);
        }

        /* Plan Day Headers */
        .plan-day-group { margin-bottom: 4px; }
        .plan-day-header {
            background: linear-gradient(135deg, var(--ocean), var(--ocean-dark));
            color: white;
            padding: 8px 14px;
            border-radius: 8px;
            font-weight: 700;
            margin: 12px 0 4px;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>Djerba Buddy ğŸï¸</h1>
            <div class="subtitle">Dein persÃ¶nlicher Urlaubs-Assistent</div>
        </div>
        
        <!-- Navigation Tabs -->
        <div class="tabs">
            <button class="tab active" data-tab="attractions">
                <div class="tab-icon">ğŸ—ºï¸</div>
                <div>AusflÃ¼ge</div>
            </button>
            <button class="tab" data-tab="taxi">
                <div class="tab-icon">ğŸš•</div>
                <div>Taxi</div>
            </button>
            <button class="tab" data-tab="budget">
                <div class="tab-icon">ğŸ’°</div>
                <div>Budget</div>
            </button>
            <button class="tab" data-tab="packing">
                <div class="tab-icon">ğŸ’</div>
                <div>Packen</div>
            </button>
            <button class="tab" data-tab="planner">
                <div class="tab-icon">ğŸ“…</div>
                <div>Planer</div>
            </button>
            <button class="tab" data-tab="phrases">
                <div class="tab-icon">ğŸ’¬</div>
                <div>Sprache</div>
            </button>
            <button class="tab" data-tab="emergency">
                <div class="tab-icon">ğŸ†˜</div>
                <div>Notfall</div>
            </button>
            <button class="tab" data-tab="achievements">
                <div class="tab-icon">ğŸ†</div>
                <div>Erfolge</div>
            </button>
        </div>
        
        <!-- Attractions Section -->
        <div id="attractions" class="section active">
            <div class="card attraction" id="card-explore" onclick="showAttractionDetails('explore')">
                <div class="card-header">
                    <div class="card-icon">ğŸŠ</div>
                    <div class="card-title">Djerba Explore Park</div>
                </div>
                <div class="attraction-meta">
                    <div class="meta-item">ğŸ“ 4 km</div>
                    <div class="meta-item">â±ï¸ 9-18 Uhr</div>
                    <div class="meta-item">ğŸ’° 15 TND</div>
                    <div class="meta-item">
                        <span class="kid-rating">ğŸ‘¶ğŸ‘¶ğŸ‘¶ğŸ‘¶</span>
                    </div>
                </div>
                <p>Krokodilfarm mit FÃ¼tterungsshow, Museum & tunesisches Dorf - DER Hit fÃ¼r Kinder!</p>
                <div class="tip">
                    <span class="tip-icon">ğŸ’¡</span>
                    FÃ¼tterung um 15 Uhr - Dein Kind wird noch Monate davon erzÃ¤hlen!
                </div>
                <div style="text-align: right;">
                    <button class="btn-visited" id="visited-explore" onclick="toggleVisited('explore', event)">â¬œ Als besucht markieren</button>
                </div>
            </div>
            
            <div class="card attraction" id="card-erriadh" onclick="showAttractionDetails('erriadh')">
                <div class="card-header">
                    <div class="card-icon">ğŸ¨</div>
                    <div class="card-title">Djerbahood / Erriadh</div>
                </div>
                <div class="attraction-meta">
                    <div class="meta-item">ğŸ“ 25 km</div>
                    <div class="meta-item">â±ï¸ Immer offen</div>
                    <div class="meta-item">ğŸ’° Kostenlos!</div>
                    <div class="meta-item">
                        <span class="kid-rating">ğŸ‘¶ğŸ‘¶ğŸ‘¶</span>
                    </div>
                </div>
                <p>250+ bunte Street-Art WandgemÃ¤lde im ganzen Dorf - Schatzsuche fÃ¼r Kinder!</p>
                <div class="tip">
                    <span class="tip-icon">ğŸ’¡</span>
                    Viele interaktive Kunstwerke als perfekte Fotokulisse!
                </div>
                <div style="text-align: right;">
                    <button class="btn-visited" id="visited-erriadh" onclick="toggleVisited('erriadh', event)">â¬œ Als besucht markieren</button>
                </div>
            </div>
            
            <div class="card attraction" id="card-beach" onclick="showAttractionDetails('beach')">
                <div class="card-header">
                    <div class="card-icon">ğŸ–ï¸</div>
                    <div class="card-title">Strand Sidi Mahrez</div>
                </div>
                <div class="attraction-meta">
                    <div class="meta-item">ğŸ“ Nah am Hotel</div>
                    <div class="meta-item">â±ï¸ 24/7</div>
                    <div class="meta-item">ğŸ’° Kostenlos</div>
                    <div class="meta-item">
                        <span class="kid-rating">ğŸ‘¶ğŸ‘¶ğŸ‘¶ğŸ‘¶</span>
                    </div>
                </div>
                <p>10km langer, flacher Sandstrand mit ruhigem Wasser - perfekt fÃ¼r 4-JÃ¤hrige!</p>
                <div class="tip">
                    <span class="tip-icon">ğŸ’¡</span>
                    Kamelritte am Strand: 15-30 TND (~5-10â‚¬)
                </div>
                <div style="text-align: right;">
                    <button class="btn-visited" id="visited-beach" onclick="toggleVisited('beach', event)">â¬œ Als besucht markieren</button>
                </div>
            </div>
            
            <div class="card attraction" id="card-market" onclick="showAttractionDetails('market')">
                <div class="card-header">
                    <div class="card-icon">ğŸ›ï¸</div>
                    <div class="card-title">Houmt Souk Markt</div>
                </div>
                <div class="attraction-meta">
                    <div class="meta-item">ğŸ“ 20 km</div>
                    <div class="meta-item">â±ï¸ 8-20 Uhr</div>
                    <div class="meta-item">ğŸ’° Handeln!</div>
                    <div class="meta-item">
                        <span class="kid-rating">ğŸ‘¶ğŸ‘¶ğŸ‘¶</span>
                    </div>
                </div>
                <p>Bunter Markt mit HandwerksvorfÃ¼hrungen & Fisch-Auktion morgens</p>
                <div class="tip">
                    <span class="tip-icon">ğŸ’¡</span>
                    Max. 30% des ersten Preises zahlen - Handeln gehÃ¶rt dazu!
                </div>
                <div style="text-align: right;">
                    <button class="btn-visited" id="visited-market" onclick="toggleVisited('market', event)">â¬œ Als besucht markieren</button>
                </div>
            </div>
            
            <div class="card attraction" id="card-pirate" onclick="showAttractionDetails('pirate')">
                <div class="card-header">
                    <div class="card-icon">ğŸ´â€â˜ ï¸</div>
                    <div class="card-title">Piraten-Bootsfahrt</div>
                </div>
                <div class="attraction-meta">
                    <div class="meta-item">ğŸ“ Vom Hafen</div>
                    <div class="meta-item">â±ï¸ 6 Stunden</div>
                    <div class="meta-item">ğŸ’° 30-40 TND</div>
                    <div class="meta-item">
                        <span class="kid-rating">ğŸ‘¶ğŸ‘¶ğŸ‘¶ğŸ‘¶</span>
                    </div>
                </div>
                <p>Piraten mit Akrobatik, Musik, Insel-Stop & Mittagessen inklusive!</p>
                <div class="tip">
                    <span class="tip-icon">ğŸ’¡</span>
                    Sehr familienfreundlich - Kinder lieben die Show!
                </div>
                <div style="text-align: right;">
                    <button class="btn-visited" id="visited-pirate" onclick="toggleVisited('pirate', event)">â¬œ Als besucht markieren</button>
                </div>
            </div>
        </div>
        
        <!-- Taxi Calculator Section -->
        <div id="taxi" class="section">
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">ğŸš•</div>
                    <div class="card-title">Taxi-Rechner</div>
                </div>
                
                <div class="input-group">
                    <label class="label">Von:</label>
                    <select id="taxiFrom">
                        <option value="0">Royal Karthago Hotel</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label class="label">Nach:</label>
                    <select id="taxiTo" onchange="calculateTaxi()">
                        <option value="">Ziel wÃ¤hlen...</option>
                        <option value="4">Djerba Explore (4 km)</option>
                        <option value="6">Midoun Stadt (6 km)</option>
                        <option value="20">Houmt Souk (20 km)</option>
                        <option value="20">Guellala (20 km)</option>
                        <option value="25">Erriadh / Street Art (25 km)</option>
                        <option value="2">Strand Sidi Mahrez (2 km)</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label class="label">Tageszeit:</label>
                    <select id="timeOfDay" onchange="calculateTaxi()">
                        <option value="day">Tag (bis 21 Uhr)</option>
                        <option value="night">Nacht (ab 21 Uhr, +50%)</option>
                    </select>
                </div>
                
                <div class="price-display" id="taxiResult" style="display:none;">
                    <div class="price-label">GeschÃ¤tzter Preis:</div>
                    <div class="price-amount" id="taxiPrice">-</div>
                    <div class="price-euro" id="taxiEuro">-</div>
                </div>
                
                <div class="tip" style="margin-top: 20px;">
                    <span class="tip-icon">ğŸ’¡</span>
                    <strong>Wichtig:</strong> Taxameter VOR Fahrtbeginn einschalten lassen! 
                    GrundgebÃ¼hr: 0,90 TND
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">ğŸ’¬</div>
                    <div class="card-title">Taxi-Phrasen</div>
                </div>
                
                <div class="phrase">
                    <div class="phrase-de">ğŸ‡©ğŸ‡ª "Wie viel kostet das?"</div>
                    <div class="phrase-translation">ğŸ‡«ğŸ‡· Combien Ã§a coÃ»te?</div>
                    <div class="phrase-phonetic">Aussprache: kom-bjÃ¤ng sa kuht</div>
                </div>
                
                <div class="phrase">
                    <div class="phrase-de">ğŸ‡©ğŸ‡ª "Das ist zu teuer"</div>
                    <div class="phrase-translation">ğŸ‡«ğŸ‡· C'est trop cher</div>
                    <div class="phrase-phonetic">Aussprache: ÃŸÃ¤ tro schÃ¤r</div>
                </div>
                
                <div class="phrase">
                    <div class="phrase-de">ğŸ‡©ğŸ‡ª "Bitte Taxameter einschalten"</div>
                    <div class="phrase-translation">ğŸ‡«ğŸ‡· Mettez le compteur, s'il vous plaÃ®t</div>
                    <div class="phrase-phonetic">Aussprache: mÃ¤tte lÃ¶ kongtÃ¶r sil wu plÃ¤</div>
                </div>
            </div>
        </div>
        
        <!-- Budget Tracker Section -->
        <div id="budget" class="section">
            <div class="budget-summary">
                <div>ğŸ’° Noch verfÃ¼gbar:</div>
                <div class="budget-amount" id="remainingBudget">500â‚¬</div>
                <div class="budget-bar">
                    <div class="budget-bar-fill" id="budgetBarFill" style="width: 100%"></div>
                </div>
                <div class="budget-status" id="budgetStatus">ğŸ˜ LÃ„UFT! Locker noch AusflÃ¼ge drin!</div>
                <button class="btn-edit-budget" onclick="toggleBudgetEdit()">âœï¸ Budget anpassen</button>
                <div class="budget-edit-form" id="budgetEditForm">
                    <input type="number" id="newBudgetAmount" placeholder="Neues Budget in â‚¬" min="1" step="10">
                    <button class="btn-save" onclick="saveBudget()">âœ… Speichern</button>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">â•</div>
                    <div class="card-title">Ausgabe hinzufÃ¼gen</div>
                </div>
                
                <div class="input-group">
                    <label class="label">Kategorie:</label>
                    <select id="expenseCategory">
                        <option value="ğŸ½ï¸">ğŸ½ï¸ Essen auÃŸerhalb</option>
                        <option value="ğŸŸï¸">ğŸŸï¸ AusflÃ¼ge</option>
                        <option value="ğŸš•">ğŸš• Taxis</option>
                        <option value="ğŸ›ï¸">ğŸ›ï¸ Souvenirs</option>
                        <option value="ğŸ‘¶">ğŸ‘¶ KinderaktivitÃ¤ten</option>
                        <option value="ğŸ">ğŸ Sonstiges</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label class="label">Betrag (â‚¬):</label>
                    <input type="number" id="expenseAmount" placeholder="z.B. 25" min="0" step="0.5">
                </div>
                
                <div class="input-group">
                    <label class="label">Beschreibung (optional):</label>
                    <input type="text" id="expenseDesc" placeholder="z.B. Djerba Explore Eintritt">
                </div>
                
                <button class="btn" onclick="addExpense()">ğŸ’° Ausgabe eintragen</button>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">ğŸ“Š</div>
                    <div class="card-title">Ausgaben-Ãœbersicht</div>
                </div>
                <div id="expensesList">
                    <p style="text-align: center; color: var(--text-light); padding: 20px;">
                        Noch keine Ausgaben eingetragen ğŸ‰
                    </p>
                </div>
            </div>

            <div class="card" id="categoryCard" style="display:none;">
                <div class="card-header">
                    <div class="card-icon">ğŸ“ˆ</div>
                    <div class="card-title">Nach Kategorie</div>
                </div>
                <div id="categoryBreakdown"></div>
            </div>
        </div>
        
        <!-- Packing List Section -->
        <div id="packing" class="section">

            <!-- Essential Banner -->
            <div class="essential-banner" id="essentialBanner">
                <div class="essential-banner-icon" id="essentialIcon">ğŸ’¡</div>
                <div class="essential-banner-content">
                    <div class="essential-banner-label">Nicht vergessen!</div>
                    <div class="essential-banner-text" id="essentialText">Sonnencreme eingepackt?</div>
                </div>
            </div>

            <!-- Packing Progress -->
            <div class="packing-progress">
                <div style="font-size: 0.9em; opacity: 0.9;">GepÃ¤ck-Fortschritt</div>
                <div class="packing-progress-text" id="packingProgressText">0 / 0 Artikel</div>
                <div class="packing-progress-bar">
                    <div class="packing-progress-fill" id="packingProgressFill" style="width: 0%"></div>
                </div>
                <div style="font-size: 0.85em; opacity: 0.8;">Artikel eingepackt âœ“</div>
            </div>

            <!-- Marc -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">ğŸ‘¨</div>
                    <div class="card-title">Marc</div>
                    <div class="person-stats" id="stats-marc">0/0</div>
                </div>
                <div id="packing-marc"></div>
                <div class="add-packing-form">
                    <input type="text" id="marc-name" placeholder="Gegenstand..." onkeydown="if(event.key==='Enter')addPackingItem('marc')">
                    <input type="number" id="marc-qty" value="1" min="1" max="99" title="Menge">
                    <button class="btn-add-item" onclick="addPackingItem('marc')">+ HinzufÃ¼gen</button>
                </div>
            </div>

            <!-- Marie -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">ğŸ‘©</div>
                    <div class="card-title">Marie</div>
                    <div class="person-stats" id="stats-marie">0/0</div>
                </div>
                <div id="packing-marie"></div>
                <div class="add-packing-form">
                    <input type="text" id="marie-name" placeholder="Gegenstand..." onkeydown="if(event.key==='Enter')addPackingItem('marie')">
                    <input type="number" id="marie-qty" value="1" min="1" max="99" title="Menge">
                    <button class="btn-add-item" onclick="addPackingItem('marie')">+ HinzufÃ¼gen</button>
                </div>
            </div>

            <!-- Marvin -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">ğŸ‘¶</div>
                    <div class="card-title">Marvin</div>
                    <div class="person-stats" id="stats-marvin">0/0</div>
                </div>
                <div id="packing-marvin"></div>
                <div class="add-packing-form">
                    <input type="text" id="marvin-name" placeholder="Gegenstand..." onkeydown="if(event.key==='Enter')addPackingItem('marvin')">
                    <input type="number" id="marvin-qty" value="1" min="1" max="99" title="Menge">
                    <button class="btn-add-item" onclick="addPackingItem('marvin')">+ HinzufÃ¼gen</button>
                </div>
            </div>

        </div>
        
        <!-- Planner Section -->
        <div id="planner" class="section">
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">ğŸ“…</div>
                    <div class="card-title">AktivitÃ¤t planen</div>
                </div>
                
                <div class="input-group">
                    <label class="label">Datum:</label>
                    <input type="date" id="planDate">
                </div>
                
                <div class="input-group">
                    <label class="label">AktivitÃ¤t:</label>
                    <input type="text" id="planActivity" placeholder="z.B. Djerba Explore besuchen">
                </div>
                
                <div class="input-group">
                    <label class="label">Uhrzeit (optional):</label>
                    <input type="text" id="planTime" placeholder="z.B. 10:00 Uhr">
                </div>
                
                <button class="btn" onclick="addPlan()">ğŸ“… HinzufÃ¼gen</button>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">ğŸ—“ï¸</div>
                    <div class="card-title">Dein Urlaubsplan</div>
                </div>
                <div id="plansList">
                    <p style="text-align: center; color: var(--text-light); padding: 20px;">
                        Noch keine AktivitÃ¤ten geplant ğŸŒ´
                    </p>
                </div>
            </div>
            
            <div class="tip">
                <span class="tip-icon">ğŸŒ¡ï¸</span>
                <strong>Wetter-Tipp:</strong> Im Juli 32-35Â°C! AusflÃ¼ge am besten morgens oder abends planen.
            </div>
        </div>
        
        <!-- Phrases Section -->
        <div id="phrases" class="section">
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">ğŸ½ï¸</div>
                    <div class="card-title">Restaurant</div>
                </div>
                
                <div class="phrase">
                    <div class="phrase-de">ğŸ‡©ğŸ‡ª Die Rechnung, bitte</div>
                    <div class="phrase-translation">ğŸ‡«ğŸ‡· L'addition, s'il vous plaÃ®t</div>
                    <div class="phrase-phonetic">la-di-ÃŸjong sil wu plÃ¤</div>
                </div>
                
                <div class="phrase">
                    <div class="phrase-de">ğŸ‡©ğŸ‡ª KindermenÃ¼?</div>
                    <div class="phrase-translation">ğŸ‡«ğŸ‡· Menu pour enfant?</div>
                    <div class="phrase-phonetic">mÃ¶-nÃ¼ pur ong-fong</div>
                </div>
                
                <div class="phrase">
                    <div class="phrase-de">ğŸ‡©ğŸ‡ª Ohne Koriander, bitte</div>
                    <div class="phrase-translation">ğŸ‡«ğŸ‡· Sans coriandre, s'il vous plaÃ®t</div>
                    <div class="phrase-phonetic">song ko-ri-ongdr sil wu plÃ¤</div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">ğŸ›ï¸</div>
                    <div class="card-title">Einkaufen / Handeln</div>
                </div>
                
                <div class="phrase">
                    <div class="phrase-de">ğŸ‡©ğŸ‡ª Wie viel kostet das?</div>
                    <div class="phrase-translation">ğŸ‡«ğŸ‡· Combien Ã§a coÃ»te?</div>
                    <div class="phrase-phonetic">kom-bjÃ¤ng sa kuht</div>
                </div>
                
                <div class="phrase">
                    <div class="phrase-de">ğŸ‡©ğŸ‡ª Das ist zu teuer</div>
                    <div class="phrase-translation">ğŸ‡«ğŸ‡· C'est trop cher</div>
                    <div class="phrase-phonetic">ÃŸÃ¤ tro schÃ¤r</div>
                </div>
                
                <div class="phrase">
                    <div class="phrase-de">ğŸ‡©ğŸ‡ª Letzter Preis?</div>
                    <div class="phrase-translation">ğŸ‡«ğŸ‡· Dernier prix?</div>
                    <div class="phrase-phonetic">dÃ¤r-njÃ¤ pri</div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">ğŸ’¬</div>
                    <div class="card-title">Allgemein</div>
                </div>
                
                <div class="phrase">
                    <div class="phrase-de">ğŸ‡©ğŸ‡ª Guten Tag</div>
                    <div class="phrase-translation">ğŸ‡«ğŸ‡· Bonjour / ğŸ‡¹ğŸ‡³ Salam</div>
                    <div class="phrase-phonetic">bong-schur / sa-lam</div>
                </div>
                
                <div class="phrase">
                    <div class="phrase-de">ğŸ‡©ğŸ‡ª Danke</div>
                    <div class="phrase-translation">ğŸ‡«ğŸ‡· Merci / ğŸ‡¹ğŸ‡³ Shukran</div>
                    <div class="phrase-phonetic">mÃ¤r-ÃŸi / schuk-ran</div>
                </div>
                
                <div class="phrase">
                    <div class="phrase-de">ğŸ‡©ğŸ‡ª Ja / Nein</div>
                    <div class="phrase-translation">ğŸ‡«ğŸ‡· Oui / Non</div>
                    <div class="phrase-phonetic">wi / nong</div>
                </div>
                
                <div class="phrase">
                    <div class="phrase-de">ğŸ‡©ğŸ‡ª Sprechen Sie Deutsch/Englisch?</div>
                    <div class="phrase-translation">ğŸ‡«ğŸ‡· Parlez-vous allemand/anglais?</div>
                    <div class="phrase-phonetic">par-le-wu al-mong/ong-glÃ¤</div>
                </div>
            </div>
        </div>
        
        <!-- Emergency Section -->
        <div id="emergency" class="section">
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">ğŸš¨</div>
                    <div class="card-title">Notfallnummern</div>
                </div>
                
                <div class="emergency-number">
                    <div class="number-info">
                        <div class="number-label">ğŸš‘ Notarzt</div>
                        <div class="number-value">190</div>
                    </div>
                    <a href="tel:190" class="call-btn">ğŸ“</a>
                </div>
                
                <div class="emergency-number">
                    <div class="number-info">
                        <div class="number-label">ğŸš“ Polizei</div>
                        <div class="number-value">197</div>
                    </div>
                    <a href="tel:197" class="call-btn">ğŸ“</a>
                </div>
                
                <div class="emergency-number">
                    <div class="number-info">
                        <div class="number-label">ğŸ‡©ğŸ‡ª Deutsche Botschaft Tunis</div>
                        <div class="number-value">+216 71 143 900</div>
                    </div>
                    <a href="tel:+21671143900" class="call-btn">ğŸ“</a>
                </div>
                
                <div class="emergency-number">
                    <div class="number-info">
                        <div class="number-label">ğŸ¥ Krankenhaus (6 km)</div>
                        <div class="number-value">In Taxi zu "HÃ´pital" fahren</div>
                    </div>
                </div>
                
                <div class="emergency-number">
                    <div class="number-info">
                        <div class="number-label">ğŸ¨ Royal Karthago Hotel</div>
                        <div class="number-value">An Rezeption wenden</div>
                    </div>
                </div>
            </div>
            
            <div class="tip">
                <span class="tip-icon">âš ï¸</span>
                <strong>Wichtig:</strong> Diese App funktioniert offline! Alle Infos sind immer verfÃ¼gbar.
            </div>
        </div>
        
        <!-- Achievements Section -->
        <div id="achievements" class="section">
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">ğŸ†</div>
                    <div class="card-title">Deine Erfolge</div>
                </div>
                
                <div id="achievementsList">
                    <!-- Achievements will be populated by JS -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal for Attraction Details -->
    <div id="attractionModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal()">&times;</span>
            <div id="modalContent"></div>
        </div>
    </div>
    
    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <!-- Install Prompt -->
    <div id="installPrompt" class="install-prompt">
        <h3>ğŸï¸ App installieren?</h3>
        <p>Installiere Djerba Buddy auf deinem Homescreen fÃ¼r schnellen Zugriff - auch offline!</p>
        <button class="btn" onclick="installApp()">ğŸ“² Jetzt installieren</button>
        <button class="btn" style="background: var(--text-light); margin-top: 8px;" onclick="dismissInstall()">SpÃ¤ter</button>
    </div>

    <script>
        // App State
        let deferredPrompt;
        let budget = {
            total: 500,
            expenses: []
        };
        let visitedAttractions = [];

        let achievements = [
            { id: 'krokodil', icon: 'ğŸŠ', title: 'Krokodil-FlÃ¼sterer', desc: 'Djerba Explore besucht', unlocked: false },
            { id: 'kamel', icon: 'ğŸª', title: 'WÃ¼sten-Krieger', desc: 'Kamelritt gemacht', unlocked: false },
            { id: 'handel', icon: 'ğŸ’°', title: 'Handels-Meister', desc: '50% Rabatt beim Markt', unlocked: false },
            { id: 'sonne', icon: 'â˜€ï¸', title: 'SonnenkÃ¶nig', desc: '7 Tage ohne Sonnenbrand', unlocked: false },
            { id: 'pirat', icon: 'ğŸ´â€â˜ ï¸', title: 'Piraten-Abenteuer', desc: 'Bootsfahrt gemacht', unlocked: false },
            { id: 'art', icon: 'ğŸ¨', title: 'Kunst-Entdecker', desc: 'Erriadh besucht', unlocked: false }
        ];
        
        // Load data from localStorage
        function loadData() {
            const savedBudget = localStorage.getItem('budget');
            if (savedBudget) {
                budget = JSON.parse(savedBudget);
                updateBudgetDisplay();
                renderExpenses();
                renderCategoryBreakdown();
            }

            const savedAchievements = localStorage.getItem('achievements');
            if (savedAchievements) {
                achievements = JSON.parse(savedAchievements);
            }
            renderAchievements();

            const savedVisited = localStorage.getItem('visitedAttractions');
            if (savedVisited) {
                visitedAttractions = JSON.parse(savedVisited);
            }
            // updateAttractionCards() called after DOM ready
            setTimeout(updateAttractionCards, 0);

            loadPackingData();
            renderAllPacking();
            showEssentialBanner();
            loadPlans();
        }
        
        // Save data to localStorage
        function saveData() {
            localStorage.setItem('budget', JSON.stringify(budget));
            localStorage.setItem('achievements', JSON.stringify(achievements));
        }
        
        // Tab Navigation
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const targetId = tab.dataset.tab;

                // Update active tab
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');

                // Update active section
                document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
                document.getElementById(targetId).classList.add('active');

                // Show new essential item every time packing tab is opened
                if (targetId === 'packing') showEssentialBanner();
            });
        });
        
        // Taxi Calculator
        function calculateTaxi() {
            const distance = parseFloat(document.getElementById('taxiTo').value);
            const timeOfDay = document.getElementById('timeOfDay').value;
            
            if (!distance) {
                document.getElementById('taxiResult').style.display = 'none';
                return;
            }
            
            const baseFare = 0.9;
            const perKm = 1.0;
            let totalTND = baseFare + (distance * perKm);
            
            if (timeOfDay === 'night') {
                totalTND *= 1.5;
            }
            
            const totalEUR = totalTND / 3.37;
            
            document.getElementById('taxiPrice').textContent = Math.round(totalTND) + ' TND';
            document.getElementById('taxiEuro').textContent = 'â‰ˆ ' + totalEUR.toFixed(2) + 'â‚¬';
            document.getElementById('taxiResult').style.display = 'block';
        }
        
        // Budget Tracker
        function addExpense() {
            const category = document.getElementById('expenseCategory').value;
            const amount = parseFloat(document.getElementById('expenseAmount').value);
            const desc = document.getElementById('expenseDesc').value;
            
            if (!amount || amount <= 0) {
                alert('Bitte einen gÃ¼ltigen Betrag eingeben!');
                return;
            }
            
            const expense = {
                id: Date.now(),
                category,
                amount,
                desc: desc || category.slice(2),
                date: new Date().toLocaleDateString('de-DE')
            };
            
            budget.expenses.push(expense);
            saveData();
            updateBudgetDisplay();
            renderExpenses();
            renderCategoryBreakdown();

            // Clear inputs
            document.getElementById('expenseAmount').value = '';
            document.getElementById('expenseDesc').value = '';
            showToast('Ausgabe eingetragen âœ…');
        }

        function deleteExpense(id) {
            if (confirm('Ausgabe wirklich lÃ¶schen?')) {
                budget.expenses = budget.expenses.filter(e => e.id !== id);
                saveData();
                updateBudgetDisplay();
                renderExpenses();
                renderCategoryBreakdown();
            }
        }
        
        function updateBudgetDisplay() {
            const spent = budget.expenses.reduce((sum, e) => sum + e.amount, 0);
            const remaining = budget.total - spent;
            const percentage = (remaining / budget.total) * 100;
            
            document.getElementById('remainingBudget').textContent = remaining.toFixed(2) + 'â‚¬';
            const fill = document.getElementById('budgetBarFill');
            fill.style.width = Math.max(0, percentage) + '%';
            fill.className = 'budget-bar-fill' + (percentage < 20 ? ' danger' : percentage < 40 ? ' warning' : '');
            
            let status = '';
            if (percentage > 70) {
                status = 'ğŸ˜ LÃ„UFT! Locker noch AusflÃ¼ge drin!';
            } else if (percentage > 40) {
                status = 'ğŸ‘ Gut im Plan!';
            } else if (percentage > 20) {
                status = 'âš ï¸ Langsam knapp...';
            } else {
                status = 'ğŸ˜¬ Fast aufgebraucht!';
            }
            
            document.getElementById('budgetStatus').textContent = status;
        }
        
        function renderExpenses() {
            const list = document.getElementById('expensesList');
            
            if (budget.expenses.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: var(--text-light); padding: 20px;">Noch keine Ausgaben eingetragen ğŸ‰</p>';
                return;
            }
            
            list.innerHTML = budget.expenses
                .sort((a, b) => b.id - a.id)
                .map(e => `
                    <div class="expense-item">
                        <div class="expense-category">
                            <div class="category-icon">${e.category}</div>
                            <div>
                                <div style="font-weight: 600;">${e.desc}</div>
                                <div style="font-size: 0.85em; color: var(--text-light);">${e.date}</div>
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div class="expense-amount">-${e.amount.toFixed(2)}â‚¬</div>
                            <button class="btn-delete" onclick="deleteExpense(${e.id})">ğŸ—‘ï¸</button>
                        </div>
                    </div>
                `).join('');
        }
        
        // Packing List
        function saveChecklist() {
            const items = Array.from(document.querySelectorAll('.checklist-item')).map(item => {
                return {
                    checked: item.querySelector('input').checked,
                    text: item.querySelector('.item-text').textContent
                };
            });
            localStorage.setItem('checklist', JSON.stringify(items));

            // Update UI
            document.querySelectorAll('.checklist-item').forEach(item => {
                if (item.querySelector('input').checked) {
                    item.classList.add('checked');
                } else {
                    item.classList.remove('checked');
                }
            });
            updatePackingProgress();
        }

        function loadChecklist() {
            const saved = localStorage.getItem('checklist');
            if (saved) {
                const items = JSON.parse(saved);
                const checkboxes = document.querySelectorAll('.checklist-item input');
                items.forEach((item, index) => {
                    if (checkboxes[index]) {
                        checkboxes[index].checked = item.checked;
                        if (item.checked) {
                            checkboxes[index].closest('.checklist-item').classList.add('checked');
                        }
                    }
                });
            }
            updatePackingProgress();
        }
        
        // Planner
        function addPlan() {
            const date = document.getElementById('planDate').value;
            const activity = document.getElementById('planActivity').value;
            const time = document.getElementById('planTime').value;
            
            if (!date || !activity) {
                alert('Bitte Datum und AktivitÃ¤t eingeben!');
                return;
            }
            
            const plans = JSON.parse(localStorage.getItem('plans') || '[]');
            plans.push({
                id: Date.now(),
                date,
                activity,
                time
            });
            localStorage.setItem('plans', JSON.stringify(plans));
            
            document.getElementById('planDate').value = '';
            document.getElementById('planActivity').value = '';
            document.getElementById('planTime').value = '';
            
            loadPlans();
        }
        
        function loadPlans() {
            const plans = JSON.parse(localStorage.getItem('plans') || '[]');
            const list = document.getElementById('plansList');

            if (plans.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: var(--text-light); padding: 20px;">Noch keine AktivitÃ¤ten geplant ğŸŒ´</p>';
                return;
            }

            const sorted = plans.sort((a, b) => new Date(a.date) - new Date(b.date));
            // Group by date
            const grouped = {};
            sorted.forEach(p => {
                if (!grouped[p.date]) grouped[p.date] = [];
                grouped[p.date].push(p);
            });

            list.innerHTML = Object.entries(grouped).map(([date, dayPlans]) => {
                const d = new Date(date + 'T00:00:00');
                const dayStr = d.toLocaleDateString('de-DE', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' });
                return `<div class="plan-day-group">
                    <div class="plan-day-header">ğŸ“… ${dayStr}</div>
                    ${dayPlans.map(p => `
                        <div class="expense-item" style="border-bottom: 1px solid var(--border); padding: 12px 0 12px 8px;">
                            <div>
                                <div style="font-weight: 700;">${p.activity}</div>
                                ${p.time ? `<div style="color: var(--text-light); font-size: 0.9em;">â° ${p.time}</div>` : ''}
                            </div>
                            <button class="btn-delete" onclick="deletePlan(${p.id})">ğŸ—‘ï¸</button>
                        </div>
                    `).join('')}
                </div>`;
            }).join('');
        }
        
        function deletePlan(id) {
            if (confirm('Plan wirklich lÃ¶schen?')) {
                let plans = JSON.parse(localStorage.getItem('plans') || '[]');
                plans = plans.filter(p => p.id !== id);
                localStorage.setItem('plans', JSON.stringify(plans));
                loadPlans();
            }
        }
        
        // Achievements
        function renderAchievements() {
            const list = document.getElementById('achievementsList');
            list.innerHTML = achievements.map(a => `
                <div class="achievement ${a.unlocked ? 'unlocked' : 'locked'}">
                    <div class="achievement-icon">${a.icon}</div>
                    <div class="achievement-info">
                        <div class="achievement-title">${a.title}</div>
                        <div class="achievement-desc">${a.desc}</div>
                    </div>
                    ${!a.unlocked ? `<button class="btn" style="width: auto; padding: 8px 16px; margin: 0;" onclick="unlockAchievement('${a.id}')">âœ… Erreicht!</button>` : '<div style="font-size: 2em;">âœ…</div>'}
                </div>
            `).join('');
        }
        
        function unlockAchievement(id) {
            const achievement = achievements.find(a => a.id === id);
            if (achievement && !achievement.unlocked) {
                achievement.unlocked = true;
                saveData();
                renderAchievements();
                
                // Show celebration
                showToast('ğŸ‰ Erfolg freigeschaltet: ' + achievement.title + '!');
            }
        }
        
        // Attraction Details Modal
        function showAttractionDetails(id) {
            const details = {
                explore: {
                    title: 'ğŸŠ Djerba Explore Park',
                    content: `
                        <h2>DER Hit fÃ¼r Kinder!</h2>
                        <p><strong>ğŸ“ Entfernung:</strong> 4 km vom Royal Karthago</p>
                        <p><strong>â±ï¸ Ã–ffnungszeiten:</strong> TÃ¤glich 9-18 Uhr</p>
                        <p><strong>ğŸ’° Eintritt:</strong> ~15 TND pro Erwachsener (~4,50â‚¬)</p>
                        <p><strong>ğŸ‘¶ Kid-Rating:</strong> ğŸ‘¶ğŸ‘¶ğŸ‘¶ğŸ‘¶ PERFEKT!</p>
                        
                        <h3>Was gibt es dort?</h3>
                        <ul>
                            <li>ğŸŠ <strong>Krokodilfarm</strong> mit Nil-Krokodilen</li>
                            <li>ğŸ­ <strong>SpektakulÃ¤re FÃ¼tterungsshow</strong> um 15 Uhr!</li>
                            <li>ğŸ›ï¸ <strong>Lalla Hadria Museum</strong> (arabische Kunst)</li>
                            <li>ğŸ˜ï¸ <strong>Traditionelles tunesisches Dorf</strong></li>
                            <li>â˜• Flaniermeile mit CafÃ©s</li>
                        </ul>
                        
                        <div class="tip" style="margin-top: 16px;">
                            <strong>ğŸ’¡ Pro-Tipp:</strong> Kommt zur FÃ¼tterungszeit um 15 Uhr! 
                            Wird voll, aber euer 4-JÃ¤hriger wird noch Monate davon erzÃ¤hlen!
                        </div>
                        
                        <h3>ğŸš• Zum Taxi-Fahrer zeigen:</h3>
                        <div style="background: var(--bg); padding: 16px; border-radius: 8px; margin: 12px 0;">
                            <div style="font-size: 1.3em; font-weight: 700;">
                                ğŸ‡«ğŸ‡· Djerba Explore Park<br>
                                ğŸ‡¹ğŸ‡³ Ù…Ø²Ø±Ø¹Ø© Ø§Ù„ØªÙ…Ø§Ø³ÙŠØ­ Ø¬Ø±Ø¨Ø© Ø¥ÙƒØ³Ø¨Ù„ÙˆØ±
                            </div>
                        </div>
                    `
                },
                erriadh: {
                    title: 'ğŸ¨ Djerbahood / Erriadh',
                    content: `
                        <h2>Street Art Paradies!</h2>
                        <p><strong>ğŸ“ Entfernung:</strong> 25 km vom Royal Karthago</p>
                        <p><strong>â±ï¸ Ã–ffnungszeiten:</strong> Immer zugÃ¤nglich</p>
                        <p><strong>ğŸ’° Eintritt:</strong> KOSTENLOS!</p>
                        <p><strong>ğŸ‘¶ Kid-Rating:</strong> ğŸ‘¶ğŸ‘¶ğŸ‘¶ Gut!</p>
                        
                        <h3>Was ist das?</h3>
                        <p>Ein ganzes Berberdorf wurde 2014 von internationalen KÃ¼nstlern mit 
                        Ã¼ber 250 bunten WandgemÃ¤lden verschÃ¶nert!</p>
                        
                        <ul>
                            <li>ğŸ¨ <strong>250+ WandgemÃ¤lde</strong> im ganzen Dorf verteilt</li>
                            <li>ğŸ“¸ <strong>Interaktive Kunstwerke</strong> als Fotokulisse</li>
                            <li>ğŸƒ <strong>"Schatzsuche"</strong> fÃ¼r Kinder - nÃ¤chstes Bild finden!</li>
                            <li>â±ï¸ <strong>Dauer:</strong> 30 Min. bis 2 Stunden</li>
                        </ul>
                        
                        <div class="tip" style="margin-top: 16px;">
                            <strong>ğŸ’¡ Pro-Tipp:</strong> Perfekt fÃ¼r Familien-Fotoshooting! 
                            Viele Kunstwerke laden zum Mitmachen ein.
                        </div>
                        
                        <h3>ğŸš• Zum Taxi-Fahrer zeigen:</h3>
                        <div style="background: var(--bg); padding: 16px; border-radius: 8px; margin: 12px 0;">
                            <div style="font-size: 1.3em; font-weight: 700;">
                                ğŸ‡«ğŸ‡· Erriadh / Djerbahood<br>
                                ğŸ‡¹ğŸ‡³ Ø§Ù„Ø±ÙŠØ§Ø¶
                            </div>
                        </div>
                    `
                },
                beach: {
                    title: 'ğŸ–ï¸ Strand Sidi Mahrez',
                    content: `
                        <h2>Der perfekte Familienstrand!</h2>
                        <p><strong>ğŸ“ Entfernung:</strong> Nah am Hotel (fuÃŸlÃ¤ufig oder kurze Fahrt)</p>
                        <p><strong>â±ï¸ Ã–ffnungszeiten:</strong> 24/7</p>
                        <p><strong>ğŸ’° Kosten:</strong> Kostenlos!</p>
                        <p><strong>ğŸ‘¶ Kid-Rating:</strong> ğŸ‘¶ğŸ‘¶ğŸ‘¶ğŸ‘¶ PERFEKT!</p>
                        
                        <h3>Warum so gut fÃ¼r Kinder?</h3>
                        <ul>
                            <li>ğŸ–ï¸ <strong>10 km langer Sandstrand</strong> - viel Platz!</li>
                            <li>ğŸ’§ <strong>Flach abfallendes Wasser</strong> - sicher fÃ¼r 4-JÃ¤hrige</li>
                            <li>ğŸŒŠ <strong>Ruhiges Meer</strong> - perfekt zum Planschen</li>
                            <li>ğŸ° <strong>Feiner Sand</strong> - ideal fÃ¼r Sandburgen</li>
                            <li>ğŸª <strong>Kamelritte mÃ¶glich</strong> - 15-30 TND (~5-10â‚¬)</li>
                        </ul>
                        
                        <div class="tip" style="margin-top: 16px;">
                            <strong>â˜€ï¸ Sonnenschutz:</strong> SPF 50+ PFLICHT! Im Juli 32-35Â°C.
                            Am besten vormittags oder nachmittags gehen.
                        </div>
                    `
                },
                market: {
                    title: 'ğŸ›ï¸ Houmt Souk Markt',
                    content: `
                        <h2>Orientalisches Shopping-Erlebnis!</h2>
                        <p><strong>ğŸ“ Entfernung:</strong> 20 km vom Royal Karthago</p>
                        <p><strong>â±ï¸ Ã–ffnungszeiten:</strong> TÃ¤glich 8-20 Uhr</p>
                        <p><strong>ğŸ’° Preise:</strong> HANDELN ist Pflicht!</p>
                        <p><strong>ğŸ‘¶ Kid-Rating:</strong> ğŸ‘¶ğŸ‘¶ğŸ‘¶ Interessant!</p>
                        
                        <h3>Was gibt es?</h3>
                        <ul>
                            <li>ğŸ¨ <strong>Handgemachte Souvenirs</strong> (Teppiche, Keramik, Schmuck)</li>
                            <li>ğŸ‘¨â€ğŸ¨ <strong>HandwerksvorfÃ¼hrungen</strong> - spannend fÃ¼r Kinder!</li>
                            <li>ğŸŸ <strong>Fisch-Auktion</strong> morgens (authentisch!)</li>
                            <li>ğŸŒ¶ï¸ <strong>GewÃ¼rze & Lebensmittel</strong></li>
                        </ul>
                        
                        <div class="tip" style="margin-top: 16px;">
                            <strong>ğŸ’° Handel-Tipp:</strong> Zahlt MAX. 30% des ersten Preises!<br>
                            <strong>Strategie:</strong> Freundlich bleiben, Preis nennen, wegdrehen wenn zu teuer ğŸ˜Š
                        </div>
                        
                        <h3>ğŸš• Zum Taxi-Fahrer zeigen:</h3>
                        <div style="background: var(--bg); padding: 16px; border-radius: 8px; margin: 12px 0;">
                            <div style="font-size: 1.3em; font-weight: 700;">
                                ğŸ‡«ğŸ‡· Houmt Souk<br>
                                ğŸ‡¹ğŸ‡³ Ø­ÙˆÙ…Ø© Ø§Ù„Ø³ÙˆÙ‚
                            </div>
                        </div>
                    `
                },
                pirate: {
                    title: 'ğŸ´â€â˜ ï¸ Piraten-Bootsfahrt',
                    content: `
                        <h2>Abenteuer auf hoher See!</h2>
                        <p><strong>ğŸ“ Start:</strong> Vom Hafen</p>
                        <p><strong>â±ï¸ Dauer:</strong> Ca. 6 Stunden (9:30 - 15:30 Uhr)</p>
                        <p><strong>ğŸ’° Preis:</strong> 30-40 TND pro Person (~10-12â‚¬)</p>
                        <p><strong>ğŸ‘¶ Kid-Rating:</strong> ğŸ‘¶ğŸ‘¶ğŸ‘¶ğŸ‘¶ ABSOLUTES HIGHLIGHT!</p>
                        
                        <h3>Was erwartet euch?</h3>
                        <ul>
                            <li>ğŸ´â€â˜ ï¸ <strong>Piraten-Show</strong> mit Akrobatik & Musik</li>
                            <li>ğŸ­ <strong>Zaubertricks</strong> an Bord</li>
                            <li>ğŸï¸ <strong>Stop an einer Insel</strong> - 1h Strand & Schwimmen</li>
                            <li>ğŸ½ï¸ <strong>Mittagessen inklusive</strong> (Fisch, Pasta, Obst)</li>
                            <li>ğŸ¥¤ <strong>GetrÃ¤nke</strong> (Wasser, Cola) inklusive</li>
                        </ul>
                        
                        <div class="tip" style="margin-top: 16px;">
                            <strong>ğŸ’¡ Pro-Tipp:</strong> Super familienfreundlich! 
                            Die Piraten sind lustig und interagieren mit den Kindern.
                            Sonnencreme & Schwimmzeug nicht vergessen!
                        </div>
                        
                        <p style="margin-top: 16px;">
                            <strong>ğŸ“ Buchung:</strong> Am besten Ã¼ber Hotel oder Reiseleitung buchen.
                        </p>
                    `
                }
            };
            
            const data = details[id];
            if (data) {
                document.getElementById('modalContent').innerHTML = `
                    <h1>${data.title}</h1>
                    ${data.content}
                `;
                document.getElementById('attractionModal').classList.add('show');
            }
        }
        
        function closeModal() {
            document.getElementById('attractionModal').classList.remove('show');
        }

        // === NEW FUNCTIONS ===

        // === CONFIGURABLE PACKING LIST ===

        const defaultPackingData = {
            marc: [
                { id: 1,   name: 'Reisepass / Ausweis',    qty: 1, checked: false },
                { id: 2,   name: 'T-Shirts',               qty: 5, checked: false },
                { id: 3,   name: 'Badehosen',              qty: 2, checked: false },
                { id: 4,   name: 'Shorts',                 qty: 3, checked: false },
                { id: 5,   name: 'UnterwÃ¤sche',            qty: 7, checked: false },
                { id: 6,   name: 'Flip-Flops',             qty: 1, checked: false },
                { id: 7,   name: 'Sonnencreme SPF 50+',    qty: 1, checked: false },
                { id: 8,   name: 'Sonnenhut / Cap',        qty: 1, checked: false },
                { id: 9,   name: 'ZahnbÃ¼rste & Zahnpasta',qty: 1, checked: false },
                { id: 10,  name: 'Ladekabel & Powerbank',  qty: 1, checked: false }
            ],
            marie: [
                { id: 101, name: 'Reisepass / Ausweis',    qty: 1, checked: false },
                { id: 102, name: 'Bikinis',                qty: 2, checked: false },
                { id: 103, name: 'Sommerkleider',          qty: 3, checked: false },
                { id: 104, name: 'UnterwÃ¤sche',            qty: 7, checked: false },
                { id: 105, name: 'Sonnencreme SPF 50+',    qty: 1, checked: false },
                { id: 106, name: 'Sonnenhut',              qty: 1, checked: false },
                { id: 107, name: 'After-Sun Lotion',       qty: 1, checked: false },
                { id: 108, name: 'ZahnbÃ¼rste & Zahnpasta',qty: 1, checked: false },
                { id: 109, name: 'Flip-Flops & Sandalen',  qty: 1, checked: false },
                { id: 110, name: 'Schminke & Pflege',      qty: 1, checked: false }
            ],
            marvin: [
                { id: 201, name: 'Reisepass',                        qty: 1, checked: false },
                { id: 202, name: 'Badehose',                         qty: 2, checked: false },
                { id: 203, name: 'T-Shirts',                         qty: 5, checked: false },
                { id: 204, name: 'SchwimmflÃ¼gel',                    qty: 1, checked: false },
                { id: 205, name: 'Sonnenhut mit Nackenschutz',       qty: 1, checked: false },
                { id: 206, name: 'Sonnencreme SPF 50+ (Kinder)',     qty: 1, checked: false },
                { id: 207, name: 'Sandspielzeug',                    qty: 1, checked: false },
                { id: 208, name: 'Lieblingskuscheltier',             qty: 1, checked: false },
                { id: 209, name: 'Snacks fÃ¼r den Flug',              qty: 1, checked: false },
                { id: 210, name: 'Windeln / UnterwÃ¤sche',            qty: 1, checked: false }
            ]
        };

        let packingData = {};

        const essentialItems = [
            { icon: 'ğŸ›‚', text: 'Reisepass eingepackt?' },
            { icon: 'ğŸ§´', text: 'Sonnencreme SPF 50+?' },
            { icon: 'ğŸª¥', text: 'ZahnbÃ¼rste vergessen?' },
            { icon: 'ğŸ”Œ', text: 'Ladekabel dabei?' },
            { icon: 'ğŸ’Š', text: 'Reiseapotheke vollstÃ¤ndig?' },
            { icon: 'ğŸ‘’', text: 'Sonnenhut nicht vergessen!' },
            { icon: 'ğŸ’³', text: 'Kreditkarte & Bargeld?' },
            { icon: 'ğŸ“±', text: 'Handy aufgeladen?' },
            { icon: 'ğŸ©´', text: 'Flip-Flops eingepackt?' },
            { icon: 'ğŸ”‹', text: 'Powerbank geladen?' },
            { icon: 'ğŸ•¶ï¸', text: 'Sonnenbrille dabei?' },
            { icon: 'ğŸ©¹', text: 'Pflaster & Verbandzeug?' },
            { icon: 'ğŸŒ¿', text: 'Insektenschutz eingepackt?' },
            { icon: 'ğŸ‘™', text: 'Badekleidung vollstÃ¤ndig?' },
            { icon: 'ğŸ“·', text: 'Kamera & LadegerÃ¤t?' },
            { icon: 'ğŸ§¸', text: 'Kuscheltier fÃ¼r Marvin?' },
            { icon: 'ğŸŠ', text: 'SchwimmflÃ¼gel eingepackt?' },
            { icon: 'ğŸŒ¡ï¸', text: 'Fieberthermometer dabei?' },
            { icon: 'ğŸ§ª', text: 'After-Sun Lotion?' },
            { icon: 'ğŸ—ºï¸', text: 'Offline-App geÃ¶ffnet?' }
        ];

        function showEssentialBanner() {
            const item = essentialItems[Math.floor(Math.random() * essentialItems.length)];
            document.getElementById('essentialIcon').textContent = item.icon;
            document.getElementById('essentialText').textContent = item.text;
        }

        function loadPackingData() {
            const saved = localStorage.getItem('packingDataV2');
            if (saved) {
                packingData = JSON.parse(saved);
                // Make sure all three people exist
                ['marc', 'marie', 'marvin'].forEach(p => {
                    if (!packingData[p]) packingData[p] = JSON.parse(JSON.stringify(defaultPackingData[p]));
                });
            } else {
                packingData = JSON.parse(JSON.stringify(defaultPackingData));
            }
            savePackingData();
        }

        function savePackingData() {
            localStorage.setItem('packingDataV2', JSON.stringify(packingData));
        }

        function renderPersonPacking(person) {
            const container = document.getElementById('packing-' + person);
            const stats = document.getElementById('stats-' + person);
            if (!container) return;
            const items = packingData[person] || [];
            const checkedCount = items.filter(i => i.checked).length;
            if (stats) stats.textContent = checkedCount + '/' + items.length;
            if (items.length === 0) {
                container.innerHTML = '<p style="text-align:center;color:var(--text-light);padding:14px 0;font-size:0.9em;">Noch leer â€“ GegenstÃ¤nde hinzufÃ¼gen!</p>';
                updatePackingProgress();
                return;
            }
            container.innerHTML = items.map(item => `
                <div class="packing-item ${item.checked ? 'checked' : ''}">
                    <input type="checkbox" ${item.checked ? 'checked' : ''} onchange="togglePackingItem('${person}', ${item.id})">
                    <div class="packing-item-name">${item.name}</div>
                    ${item.qty > 1 ? `<div class="packing-item-qty">Ã—${item.qty}</div>` : ''}
                    <button class="packing-item-del" onclick="deletePackingItem('${person}', ${item.id})" title="LÃ¶schen">ğŸ—‘ï¸</button>
                </div>`).join('');
            updatePackingProgress();
        }

        function renderAllPacking() {
            renderPersonPacking('marc');
            renderPersonPacking('marie');
            renderPersonPacking('marvin');
        }

        function togglePackingItem(person, id) {
            const item = (packingData[person] || []).find(i => i.id === id);
            if (item) {
                item.checked = !item.checked;
                savePackingData();
                renderPersonPacking(person);
            }
        }

        function deletePackingItem(person, id) {
            packingData[person] = (packingData[person] || []).filter(i => i.id !== id);
            savePackingData();
            renderPersonPacking(person);
        }

        function addPackingItem(person) {
            const nameEl = document.getElementById(person + '-name');
            const qtyEl  = document.getElementById(person + '-qty');
            const name = nameEl.value.trim();
            const qty  = Math.max(1, parseInt(qtyEl.value) || 1);
            if (!name) { showToast('Bitte einen Namen eingeben'); return; }
            if (!packingData[person]) packingData[person] = [];
            packingData[person].push({ id: Date.now(), name, qty, checked: false });
            savePackingData();
            renderPersonPacking(person);
            nameEl.value = '';
            qtyEl.value  = '1';
            nameEl.focus();
            showToast(name + ' hinzugefÃ¼gt âœ…');
        }

        // Toast notification (replaces alert)
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            clearTimeout(toast._timer);
            toast._timer = setTimeout(() => toast.classList.remove('show'), 3000);
        }

        // Visited Attractions
        function toggleVisited(id, event) {
            event.stopPropagation();
            if (visitedAttractions.includes(id)) {
                visitedAttractions = visitedAttractions.filter(v => v !== id);
                showToast('Besuch-Status entfernt');
            } else {
                visitedAttractions.push(id);
                showToast('Als besucht markiert! âœ…');
            }
            localStorage.setItem('visitedAttractions', JSON.stringify(visitedAttractions));
            updateAttractionCards();
        }

        function updateAttractionCards() {
            const ids = ['explore', 'erriadh', 'beach', 'market', 'pirate'];
            ids.forEach(id => {
                const card = document.getElementById('card-' + id);
                const btn = document.getElementById('visited-' + id);
                if (!card || !btn) return;
                const isVisited = visitedAttractions.includes(id);
                card.classList.toggle('visited-card', isVisited);
                // Remove old badge if exists
                const oldBadge = card.querySelector('.visited-badge');
                if (oldBadge) oldBadge.remove();
                if (isVisited) {
                    const badge = document.createElement('div');
                    badge.className = 'visited-badge';
                    badge.textContent = 'âœ… Besucht';
                    card.appendChild(badge);
                    btn.textContent = 'âœ… Besucht!';
                } else {
                    btn.textContent = 'â¬œ Als besucht markieren';
                }
            });
        }

        // Packing Progress (uses packingData state)
        function updatePackingProgress() {
            let total = 0, checked = 0;
            ['marc', 'marie', 'marvin'].forEach(p => {
                const items = packingData[p] || [];
                total   += items.length;
                checked += items.filter(i => i.checked).length;
            });
            const pct = total > 0 ? (checked / total) * 100 : 0;
            const el   = document.getElementById('packingProgressText');
            const fill = document.getElementById('packingProgressFill');
            if (el)   el.textContent = checked + ' / ' + total + ' Artikel';
            if (fill) fill.style.width = pct + '%';
        }

        // Category Breakdown
        function renderCategoryBreakdown() {
            const card = document.getElementById('categoryCard');
            const breakdown = document.getElementById('categoryBreakdown');
            if (budget.expenses.length === 0) {
                card.style.display = 'none';
                return;
            }
            card.style.display = 'block';
            const map = {};
            budget.expenses.forEach(e => {
                map[e.category] = (map[e.category] || 0) + e.amount;
            });
            const total = Object.values(map).reduce((a, b) => a + b, 0);
            breakdown.innerHTML = Object.entries(map)
                .sort((a, b) => b[1] - a[1])
                .map(([cat, amount]) => {
                    const pct = (amount / total) * 100;
                    return `<div class="category-bar">
                        <div class="category-bar-label">${cat}</div>
                        <div class="category-bar-track">
                            <div class="category-bar-fill" style="width:${pct}%"></div>
                        </div>
                        <div class="category-bar-amount">${amount.toFixed(2)}â‚¬</div>
                    </div>`;
                }).join('');
        }

        // Budget editing
        function toggleBudgetEdit() {
            const form = document.getElementById('budgetEditForm');
            form.classList.toggle('show');
            if (form.classList.contains('show')) {
                document.getElementById('newBudgetAmount').value = budget.total;
                document.getElementById('newBudgetAmount').focus();
            }
        }

        function saveBudget() {
            const val = parseFloat(document.getElementById('newBudgetAmount').value);
            if (!val || val <= 0) {
                showToast('Bitte ein gÃ¼ltiges Budget eingeben');
                return;
            }
            budget.total = val;
            saveData();
            updateBudgetDisplay();
            document.getElementById('budgetEditForm').classList.remove('show');
            showToast('Budget auf ' + val + 'â‚¬ gesetzt âœ…');
        }

        // Close modal when clicking outside
        document.getElementById('attractionModal').addEventListener('click', (e) => {
            if (e.target.id === 'attractionModal') {
                closeModal();
            }
        });
        
        // PWA Install
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Show install prompt after 3 seconds
            setTimeout(() => {
                if (!localStorage.getItem('installDismissed')) {
                    document.getElementById('installPrompt').classList.add('show');
                }
            }, 3000);
        });
        
        function installApp() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('App installed');
                    }
                    deferredPrompt = null;
                    document.getElementById('installPrompt').classList.remove('show');
                });
            }
        }
        
        function dismissInstall() {
            document.getElementById('installPrompt').classList.remove('show');
            localStorage.setItem('installDismissed', 'true');
        }
        
        // Register Service Worker for offline support
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('data:text/javascript;base64,Y29uc3QgQ0FDSEVfTkFNRSA9ICdkamVyYmEtYnVkZHktdjEnOwpjb25zdCB1cmxzVG9DYWNoZSA9IFsnLyddOwoKc2VsZi5hZGRFdmVudExpc3RlbmVyKCdpbnN0YWxsJywgZXZlbnQgPT4gewogIGV2ZW50LndhaXRVbnRpbChjYWNoZXMub3BlbihDQUNIRV9OQU1FKS50aGVuKGNhY2hlID0+IGNhY2hlLmFkZEFsbCh1cmxzVG9DYWNoZSkpKTsKfSk7CgpzZWxmLmFkZEV2ZW50TGlzdGVuZXIoJ2ZldGNoJywgZXZlbnQgPT4gewogIGV2ZW50LnJlc3BvbmRXaXRoKGNhY2hlcy5tYXRjaChldmVudC5yZXF1ZXN0KS50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlIHx8IGZldGNoKGV2ZW50LnJlcXVlc3QpKSk7Cn0pOw==')
                    .catch(err => console.log('Service worker registration failed:', err));
            });
        }
        
        // Initialize app
        loadData();
    </script>
</body>
</html>
